services:
  - type: web
    name: tradetron-token-generator
    env: docker
    plan: free
    dockerContext: .
    dockerfilePath: Dockerfile
    numInstances: 1
    healthCheckPath: /api/health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: TZ
        value: Asia/Kolkata
      - key: NEXT_TELEMETRY_DISABLED
        value: 1
      # Override Dockerfile's 4GB limit to fit Render Free Tier (512MB)
      - key: NODE_OPTIONS
        value: --max-old-space-size=460
      # Limit concurrency to 1 to save memory on free tier
      - key: MAX_CONCURRENCY
        value: 1
      # Time Window Configuration (Open by default for Render)
      - key: TIME_WINDOW_ENABLED
        value: true
      - key: TIME_WINDOW_START
        value: 00:01
      - key: TIME_WINDOW_END
        value: 23:59
      - key: TIME_WINDOW_TIMEZONE
        value: Asia/Kolkata
      # User must provide these in Render Dashboard
      - key: SECRET_KEY
        sync: false
      - key: CRON_SECRET
        sync: false
      - key: GOOGLE_SHEETS_URL
        sync: false
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: TELEGRAM_CHAT_ID
        sync: false
